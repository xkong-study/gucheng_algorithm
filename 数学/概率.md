# §2.2 组合计数专题涉及的常见数学算法

## 排列组合基础

<img width="263" alt="Screenshot 2025-04-13 at 19 57 53" src="https://github.com/user-attachments/assets/f914a0bf-d6b3-4804-bf4c-ac1d9b6d70f5" />


## 子序列 / 子集计数
- 所有子集数：<img width="39" alt="Screenshot 2025-04-13 at 19 58 07" src="https://github.com/user-attachments/assets/7f06109e-6a1b-470f-9ce6-cd65021592c0" />
- 特定频率构造（哈希 + 排列组合）
- 字符串美丽值优化（计数 + 字符特征）

## 路径计数 / 网格路径
- 网格路径：\( C(m+n, m) \)
- 限制步数路径（如正好 K 步）：排列选步
- 字典序第 k 小路径：组合数引导构造

## 错位排列（Derangement）
- 递推公式：\( D(n) = (n-1)(D(n-1) + D(n-2)) \)
- 初始条件：\( D(1) = 0, D(2) = 1 \)

## 卡特兰数（Catalan Number）
- <img width="185" alt="Screenshot 2025-04-13 at 19 59 41" src="https://github.com/user-attachments/assets/be58fef9-a346-4a73-9ba4-4f4ecc62c49c" />
- 括号合法结构、BST 数量、出栈序列

## 第一类斯特林数
- 计数：将 n 个元素排成 k 个非空环
- 应用：可见木棍排列（LeetCode 1866）

## 第二类斯特林数
- 计数：将 n 个元素分成 k 个非空无序子集
- 递推公式: <img width="381" alt="Screenshot 2025-04-13 at 19 58 29" src="https://github.com/user-attachments/assets/37623a8b-8a90-45c6-8e6f-c8e26a12d6f2" />
- 应用：安排活动方案、分糖果方案

## 多重集组合 / 排列
- 有重复元素的排列数：<img width="69" alt="Screenshot 2025-04-13 at 19 58 45" src="https://github.com/user-attachments/assets/bb14af2d-81a2-46dd-8311-0691b105a025" />
- 应用：字符串重排次数、感冒序列

## 排列构造类问题（构造第 k 小）
- K 阶指令 / 排列字典序构造
- 利用组合数估计前缀范围

## 概率问题中的组合计算
- 如颜色数期望、两盒相等颜色概率等
- 通常是组合数 / 总数 形式的比值

---

# §2.3 放球问题（隔板法 / 多重集组合）

- 本质是将 n 个球放入 k 个盒子
- 若每个盒子至少一个球 → 使用隔板法：\( C(n-1, k-1) \)
- 若球可为空，可用于字典序、理想数组、乘积构造等问题
- 对应多重集组合、隔板法与乘法原理结合的思维建模

常见题型：
- 元音排列（1641）
- 不重叠线段构造
- 生成排列、播放序列构造、理想数组的方案数等

---

# §2.4 容斥原理

- 用于计数“至少满足一个条件”的个数：

<img width="317" alt="Screenshot 2025-04-13 at 19 59 01" src="https://github.com/user-attachments/assets/0546eaed-c55a-4de3-93bb-bd07d819d351" />


- 多集合交错相加减计数：处理重复计数或重叠条件
- 延伸技巧包括「二进制枚举子集」、「莫比乌斯函数容斥」等

典型题型：
- 倍数和 / 丑数计数
- 字符串包含方案 / 最小化最大值
- 第 k 小金额组合数
- 莫比乌斯函数优化容斥（如 gcd 相等子序列）

---

# §2.5 贡献法

- 枚举每个位置对最终答案的「贡献」
- 拆解为：每个元素在哪些子数组中出现过？在哪些起到最大/最小作用？
- 用于子数组和、区间计数、子序列宽度等问题

常见技巧：
- 前后最近更大 / 更小 → 单调栈优化
- 贡献次数 × 元素值 叠加求和

代表题：
- 所有元音 / 奇数子数组贡献
- 子序列最小值 / 最大值之和
- 曼哈顿距离总和（枚举点对差值 × 贡献）

---

# §2.6 概率与期望

## 概率基本知识
- 所有可能事件的总概率为 1
- 概率 = 满足条件的情况数 ÷ 总情况数
- 动态规划可用于模拟状态转移概率
- 某些题目可用「记忆化搜索 + 概率累积」计算

## 期望计算方式

<img width="584" alt="Screenshot 2025-04-13 at 19 59 16" src="https://github.com/user-attachments/assets/a346917b-8680-45b7-9fd5-511d8ec817bb" />

## 常见题型类型：

- 飞机座位分配概率 ⇒ 数学归纳 + 观察结论（1227）
- 骑士在棋盘上的概率 ⇒ 概率 DP + 边界转移（688）
- 新 21 点 ⇒ 状态 DP + 滚动前缀和优化（837）
- 球颜色概率 ⇒ 组合数 + 总体空间枚举 + 概率求和（1467）
- 分汤 ⇒ 记忆化搜索 + 双重状态空间（808）
- LCR 185. 多人对局结果概率统计 ⇒ 状态枚举 + 前缀概率
- LCP 11. 期望个数统计 ⇒ 概率线性贡献模型
- 九坤 04. 筹码博弈 ⇒ 动态策略期望最优
- 1230. 抛硬币期望统计 ⇒ 状态 DP + 组合概率模型

## 技巧模板：
- DP 状态设为概率 / 期望值数组 dp[i][j]
- 多种选择用加法叠加概率；有条件跳转用转移概率 × 子状态值
- 若涉及递归，可考虑「状态空间缩小 + 记忆化」

---

